## 生命周期和插件 ##

Maven 的 **生命周期** 就是为了对所有的构建过程进行抽象和统一。Maven 从大量项目和构建工具中学习和反思，总结了一套高度完善的、易扩展的生命周期，包括项目的清理、初始化、编译、测试、打包、集成测试、验证、部署和站点生成等几乎所有的构建步骤。也就是说，几乎所有项目的构建，都能映射到这样一个生命周期上。

Maven 的生命周期是抽象的，这意味着生命周期本身不做任何实际的工作，在 Maven 的设计中，实际的任务（如编译源代码）都交给 **插件** 来完成。每个构建步骤都可以绑定一个或者多个插件行为，而且 Maven 为大多数构建步骤编写并绑定了默认插件，例如针对编译的插件有 maven-compiler-plugin。当用户有特殊需要的时候，也可以配置插件定制构建行为，甚至自己编写插件。

Maven 定义的生命周期和插件机制一方面保证了所有 Maven 项目有一致的构建标准，另一方面又通过默认插件简化和稳定了实际项目的构建。此外，该机制还提供了足够的扩展空间，用户可以通过配置现有插件或者自行编写插件来自定义构建行为。


### 生命周期 ###

Maven 有三套相互独立的生命周期，分别为 `clean`、`default`、`site`。每个生命周期包含一些阶段（`phase`），这些阶段是有顺序的，并且后面的阶段依赖于前面的阶段，用户和 Maven 最直接的交互方式就是调用这些生命周期阶段。

#### `clean` 生命周期 ####

目的是清理项目。包括三个阶段：

* `pre-clean` 清理前需要完成的工作
* `clean` 清理上一次构建生成的文件
* `post-clean` 清理后需要完成的工作

#### `default` 生命周期 ####

定义了真正构建时所需要执行的所有步骤，是所有生命周期中最核心的部分。
包括的重要阶段有：

* `compile` 编译项目的主代码，即编译 src/main/java 目录下的 Java 文件到项目输出目录。
* `test` 使用单元测试框架运行测试，测试代码不会被打包或部署。
* `package` 接受编译好的代码，打包成可发布的格式，如 JAR。
* `install` 将包安装到 Maven 本地仓库，供本地其他 Maven 项目使用。
* `deploy` 将最终的包复制到远程仓库，供其他开发人员和 Maven 项目使用。

#### `site` 生命周期 ####

目的是建立和发布项目站点，Maven 能够基于 POM 所包含的信息，自动生成一个友好的站点，方便团队交流和发布项目信息。

#### 命令行 ####

从命令行执行 Maven 任务的最主要方式就是调用 Maven 的生命周期阶段。Maven 命令都是以 mvn 开头，基于生命周期阶段简单组合而成的常用命令如下：

`mvn clean` 调用 clean 生命周期的 clean 阶段。实际执行的阶段为 clean 生命周期的 pre-clean 和 clean 阶段。

`mvn test` 调用 default 生命周期的 test 阶段。实际执行的阶段为 default 生命周期的 validate、 initilaize 等直到 test 的所有阶段。

`mvn clean install` 调用 clean 生命周期的 clean 阶段和 default 生命周期的 install 阶段。实际执行的阶段为 clean 生命周期的 pre-clean、clean 阶段，以及 default 生命周期的从 validate 至 install 的所有阶段。
