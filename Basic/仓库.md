## 仓库 ##

在 Maven 中，任何一个依赖、插件或者项目构建的输出，都可以称为构件（artifact），任何一个构件都有一组坐标唯一标识。

坐标和依赖是任何一个构件在 Maven 世界中的逻辑表示方式；而构件的物理表示方式是文件（jar、war、pom等），Maven 通过仓库来统一管理这些文件。

得益于坐标机制，任何 Maven 项目使用任何一个构件的方式都是完全相同的。在此基础上，Maven 可以在某个位置统一存储所有 Maven 项目共享的构件，这个统一的位置就是仓库（repository）。实际的 Maven 项目将不再各自存储其依赖文件，它们只需要声明这些依赖的坐标，在需要的时候（如编译时），Maven 会自动根据坐标找到仓库中的构件，并使用它们。

为了实现重用，项目构建完毕后生成的构件也可以安装或者部署到仓库中，供其他项目使用。

### 仓库的布局 ###

根据构件的坐标可以定义其在仓库中的唯一存储路径，这便是 Maven 的仓库布局方式。例如 `log4j:log4j:1.2.15` 这一依赖，其对应的仓库路径为 log4j/log4j/1.2.15/log4j-1.2.15.jar。

Maven 仓库是基于简单文件系统存储的，因此当遇到一些与仓库相关的问题时，可以很方便地查找相关文件定位问题。

### 仓库的分类 ###

仓库分为两类：本地仓库和远程仓库 。当 Maven 根据坐标寻找构件的时候，它首先会查看本地仓库，如果本地仓库存在此构件，则直接使用；如果本地仓库不存在此构件，或者需要查看是否有更新的构件版本，Maven 就会去远程仓库查找，发现需要的构件之后，下载到本地仓库再使用。如果本地仓库和远程仓库都没有需要的构件，Maven 就会报错。

中央仓库是 Maven 核心自带的远程仓库，它包含了绝大部分开源的构件。私服是另一种特殊的远程仓库，为了节省带宽和时间，应该在局域网内架设一个私有的仓库服务器，用其代理所有外部的远程仓库。内部的项目还能部署到私服上供其他项目使用。

在 Maven 项目目录下，没有诸如 lib/ 这样用来存放依赖文件的目录。当 Maven 在执行编译或测试时，如果需要使用依赖文件，它总是基于坐标使用本地仓库的依赖文件。默认情况下，每个用户在自己的用户目录下都有一个路径为 `.m2/repository` 的仓库目录，该目录下除了 repository 仓库之外就没有其他目录和文件了，但是大多数 Maven 用户需要复制 `M2_HOME/conf/settings.xml` 文件到 `.m2/settings.xml`，而不是直接修改 `M2_HOME/conf/settings.xml` 这个全局配置文件，这是一条最佳实践。具体设置详见 `settings.xml` 文件。

### SNAPSHOT 版本 ###

Maven 的快照版本机制是为了解决频繁发布的问题。在发布的过程中，Maven 会自动为构件打上时间戳，比如 `2.1-20151214.221234-13` 就表示 2015年12月14日22点12分34秒的第13次快照。有了该时间戳，Maven 就能随时找到仓库中该构件 `2.1-SNAPSHOT` 版本最新的文件。

当某个依赖 `2.1-SNAPSHOT` 的模块被构建时，Maven 会自动从仓库中检查 `2.1-SNAPSHOT` 的最新构件，当发现有更新时便进行下载。默认情况下，Maven 每天检查一次更新（由仓库配置的 updatePolicy 控制）。

当项目经过完善的测试后需要发布的时候，就应该将快照版本更改为发布版本。快照版本只应该在组织内部的项目或模块间依赖使用，项目也不应该依赖于任何组织外部的快照版本。

### 仓库搜索服务 ###

可以使用仓库搜索服务来寻找需要的依赖，只需要知道使用类库的项目名称，就可以搜索到确切的 Maven 坐标。

常用的搜索服务有：
http://repository.sonatype.org/